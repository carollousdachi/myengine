var url=window.location.pathname,parts=url.split("/"),link=parts[parts.length-1];function getSidebar(){$.ajax({url:link+"/getSidebar",type:"POST",dataType:"json",success:function(response){$("#nav").html(response.data),$("#title").text(response.title),getLink()}})}function validateName(name){$.ajax({url:link+"/validateName",type:"POST",data:{name:name},dataType:"json",success:function(response){0!=response.length&&showMsg("Nama yang anda gunakan sudah ada.",0)}})}function getLink(){$.ajax({url:link+"/getRootLink",type:"POST",dataType:"json",success:function(result){$("#nav").find("#"+link).each((function(){$(this).addClass("nav-link active",$(this).attr("href")==url)})),$("#nav").find("#"+result.data).each((function(){$(this).addClass("nav-link active",$(this).attr("href")==url)})),$("#nav").find("#"+result.data+"1").each((function(){$(this).addClass("nav-item has-treeview menu-open",$(this).attr("href")==url)}))}})}function myFunction(){var input,filter,table,tr,td,i,txtValue;for(filter=(input=document.getElementById("myInput")).value.toUpperCase(),tr=(table=document.getElementById("viewModal")).getElementsByTagName("tr"),i=0;i<tr.length;i++)(td=tr[i].getElementsByTagName("td")[1])&&((txtValue=td.textContent||td.innerText).toUpperCase().indexOf(filter)>-1?tr[i].style.display="":tr[i].style.display="none")}function showMsg(msg,tipe_msg){var msg_tipe="alert-danger",msg_name="Error";switch(tipe_msg){case 1:msg_tipe="alert-primary",msg_name="Info"}$msg_view='<div class="alert '+msg_tipe+' alert-dismissible fade show" role="alert">\n            <strong>'+msg_name+":</strong><br/>"+msg+'<button type="button" class="close" data-dismiss="alert" aria-label="Close">\n              <span aria-hidden="true">&times;</span>\n            </button>\n          </div>',$("#pesan").append($msg_view)}function showDataTable(callColumn=""){var table;$(document).ready((function(){var link=$(location).attr("pathname");table=$("#tbl_data").DataTable({responsive:!0,serverSide:!0,autoWidth:!1,sScrollY:"500",sScrollX:"100%",bSort:!0,iDisplayLength:10,bLengthChange:!1,order:[],ajax:{url:link+"/get_data",type:"POST"},columnDefs:callColumn})})),$("#searchbox").on("keyup search input paste cut",(function(){table.search(this.value).draw()}))}getSidebar(),$('input[name="name"]').on("input",(function(){validateName($(this).val())})),$((function(){$(".select2-purple").select2(),$(".select2bs4").select2({theme:"bootstrap4"})})),$("#form-submit").on("submit",(function(e){e.preventDefault(),Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"success",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, create it!"}).then(result=>{if(result.isConfirmed){var data=$("#form-submit").serialize();$.ajax({type:"POST",url:link+"/tambahData",data:data,success:function(response){Swal.fire("Created!","Your file has been created.","success"),$("#form-submit")[0].reset(),$("#tbl_data").DataTable().ajax.reload(null,!1),getSidebar(),$("#modalform").modal("hide"),sumtotal()&&sumtotal()}})}})})),$("#reset").click((function(){$.ajax({type:"POST",url:link+"/reset",success:function(response){$("#tbl_data").DataTable().ajax.reload(null,!1),$("#sumtotal").val(""),$("#customer").val(""),$("#cash").val("")}})})),$("#pembayaran").click((function(){var data=$("#form-submit").serialize();""==$("#customer").val()?(showMsg("Wajib masukkan nama customer."),$("html, body").animate({scrollTop:0},"slow")):Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"success",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, create it!"}).then(result=>{if(result.isConfirmed){$("#sumtotal").val(""),$("#tax").val("");var data=$("#form-submit").serialize();$.ajax({type:"POST",url:link+"/updateData",data:data,success:function(response){$("#cash").val(""),$("#customer").val(""),$("#tbl_data").DataTable().ajax.reload(null,!1),$("#form-submit").reset()}})}})})),$("#tbl_data").on("click",".btn_hapus",(function(){var id=$(this).attr("data-id");Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(result=>{result.isConfirmed&&$.ajax({url:link+"/hapusData",type:"POST",data:{id:id},success:function(response){Swal.fire("Deleted!","The item has been deleted.","success"),$("#tbl_data").DataTable().ajax.reload(null,!1)}})})})),$("#tbl_data").on("click",".btn_hapus_detail",(function(){var id=$(this).attr("data-id");Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(result=>{result.isConfirmed&&$.ajax({url:link+"/hapusDataDetail",type:"POST",data:{id:id},success:function(response){Swal.fire("Deleted!","The item has been deleted.","success"),$("#tbl_data").DataTable().ajax.reload(null,!1),$("#sumtotal").val("")}})})})),$("#tbl_data").on("click",".btn_edit",(function(){var id=$(this).attr("data-id");$.ajax({url:link+"/ambilDataById",type:"POST",data:{id:id},dataType:"json",success:function(response){$("#editModal").modal("show");for(var i=0;i<=response.key_count;i++)dummyval=response.key[i],$("#"+response.key[i]+"_edit").val(response.data[dummyval]);$("#tbl_data").DataTable().ajax.reload(null,!1)}})})),$("#btn_update_data").on("click",(function(){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"success",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update it!"}).then(result=>{if(result.isConfirmed){var data=$("#form-edit").serialize();$.ajax({url:link+"/perbaruiData",type:"POST",data:data,success:function(response){console.log(response),$("#form-edit")[0].reset(),$("#editModal").modal("hide"),$("#tbl_data").DataTable().ajax.reload(null,!1)}})}})}));